/**
*	@name						Simple Slides
*	@descripton					Turns the elements inside a div into slides
*							with assigned transitions, handles image loading, and can act 
*							as a slideshow. 
*	@version					0.1.0
*	@requires					Jquery 1.4+
*
*	@author						Ben Gullotti
*	@author-email					ben@bengullotti.com
*
*	@license					MIT License - http://www.opensource.org/licenses/mit-license.php
*/
(function(a){var b={appendImage:function(b,c){if(typeof c==="string"){b.append('<img src="'+c+'" />')}else if(typeof c==="object"&&typeof c.src==="string"){a("<img/>",c).appendTo(b)}else{a.error("Simple Slides Error: invalid image. Specify "+"src as a string or object property.")}},getAttributes:function(a){var b={};for(var c=0,d=a.attributes,e=d.length;c<e;c++){b[d.item(c).nodeName]=d.item(c).nodeValue}return b},wrapElement:function(b){var c=a("<div></div>").insertAfter(b);b.remove();c.append(b);c.css({width:"100%",height:"100%",position:"relative",top:"0px",left:"0px",display:"block","z-index":0});b.css({display:"block",position:"relative",top:"0px",left:"0px"});return c}};var c={methods:function(b){var d=this.filter(function(){if(a(this).data("SimpleSlides.global")===null){a.error('Simple Slides Error: method "'+b+'" was called on an element '+"which has not initialized the plugin");return false}return true});if(d.length===0){return false}if(typeof c[b]==="function"){c[b].apply(d,Array.prototype.slice.call(arguments,1))}else{i[b].apply(d,Array.prototype.slice.call(arguments,1))}},goTo:function(b){if(typeof b==="undefined"){a.error("Simple Slides Error: method goTo expects second argument the "+"slide #.");return false}if(typeof b!=="number"){b=parseInt(b)}var c=this.filter(function(){var c=a(this).data("SimpleSlides.global");var d=c.state.getState();if(d==="load"||d==="pause-in"||d==="pause-tr"){return false}if(!c.overflow){if(d==="play-tr"||d==="stop-tr"){return false}}else{if(c.transitions.length>=c.maxOverflow||c.transitions.length+1>=c.total){return false}}if(b===c.slide){a.error("Simple Slides Error: method goTo() called for current slide #"+b);return false}if(b<0||b>=c.total){a.error("Simple Slides Error: slide parameter ("+b+") passed to goTo() "+"must be a number greater than 0 and less than the total slides ("+c.total+")");return false}if(a(this).children().eq(b).css("visibility")==="visible"){return false}if(d==="play-in"){c.timer.reset()}return true});if(c.length===0){return false}i.goTo.call(c,b)}};var d=function(a,b){this.id=a;this.index=b};d.prototype={getContainer:function(){return a(".simpleSlides"+this.id)},getWrapper:function(){return a(".simpleSlides"+this.id).children().eq(this.index)},getSlide:function(){return a(".simpleSlides"+this.id).children().eq(this.index).children().first()}};var e=function(){this.isPlaying=false;this.isPaused=false;this.isTransit=false;this.isLoading=false};e.prototype={getState:function(){if(this.isLoading){return"load"}if(this.isPlaying&&!this.isPaused&&!this.isTransit){return"play-in"}if(this.isPlaying&&!this.isPaused){return"play-tr"}if(this.isPlaying&&this.isPaused&&!this.isTransit){return"pause-in"}if(this.isPlaying&&this.isPaused){return"pause-tr"}if(!this.isTransit){return"stop-in"}return"stop-tr"},setState:function(a){switch(a){case"load":this.isLoading=true;break;case"noload":this.isLoading=false;break;case"play":this.isPlaying=true;this.isPaused=false;break;case"pause":this.isPlaying=true;this.isPaused=true;break;case"stop":this.isPlaying=false;this.isPaused=false;break;case"tr":this.isTransit=true;break;case"no-tr":this.isTransit=false;break}}};var f=function(){this.loader=false;this.slide=false;this.total=0;this.count=0;this.duration=500};f.prototype={showLoader:function(){if(!this.loader){return false}this.loader.getWrapper().css("visibility","hidden");var a=parseFloat(this.loader.getSlide().css("opacity"));var b=this.duration*(1-a);this.loader.getSlide().animate({opacity:1},b)},hideLoader:function(){if(!this.loader){return false}this.loader.getSlide().stop();var a=parseFloat(this.loader.getSlide().css("opacity"));var b=this.duration*a;var c=this.loader.getWrapper();this.loader.getSlide().stop().animate({opacity:0},b,function(){c.css("visibility","hidden")})},loadImage:function(c){this.showLoader();var d=b.getAttributes(c.get(0));var e=a("<img/>");c.replaceWith(e);var f=this;e.load(function(){f.count++;if(f.count===f.total){f.reset();f.hideLoader();f.slide.getWrapper().data("SimpleSlides.loaded",true);f.slide.getContainer().data("SimpleSlides.global").state.setState("noload");i.goTo.call(f.slide.getContainer(),f.slide.index)}});e.attr(d)},load:function(b){this.slide=b;this.slide.getContainer().data("SimpleSlides.global").state.setState("load");var c=this.slide.getWrapper().find("img");if(c.length){this.total=c.length;var d=this;c.each(function(){d.loadImage(a(this))})}else{this.slide.getWrapper().data("SimpleSlides.loaded",true);this.slide.getContainer().data("SimpleSlides.global").state.setState("noload");i.goTo.call(this.slide.getContainer(),this.slide.index)}},reset:function(){this.slide.getWrapper().find("img").unbind("load");this.count=0;this.total=0;this.hideLoader()}};var g=function(){function b(){a.count+=a.increment;if(a.count>=a.duration){var b=a.callback;a.reset();if(b){b()}}else{a.counting()}}var a=this;this.timeout=null;this.increment=50;this.callback=false;this.isTiming=false;this.isCounting=false;this.duration=0;this.count=0;this.counting=function(){this.timeout=setTimeout(function(){b()},this.increment)}};g.prototype={percent:function(){return Math.round(this.count/this.duration*1e3)/1e3},start:function(){if(this.isCounting){return false}if(typeof arguments[0]==="number"){this.duration=arguments[0]}if(typeof arguments[1]==="function"){this.callback=arguments[1]}this.isTiming=true;this.isCounting=true;this.counting();return true},stop:function(){if(this.isCounting){this.isCounting=false;clearTimeout(this.timeout);return true}return false},reset:function(){this.stop();this.isTiming=false;this.callback=false;this.count=0;this.duration=0}};var h=function(){if(typeof arguments[0]==="object"){this.timer=arguments[0]}else{this.timer=new g}this.ssA=false;this.ssB=false;this.animation="fade";this.duration=1e3;this.queue=1;this.overflow=false;this.callback=false};h.prototype={setProperties:function(){var b=this;if(typeof arguments[0]==="object"){a.each(arguments[0],function(a,c){if(typeof b[a]!=="undefined"){b[a]=c}})}},animate:function(){var a=this.timer.percent();var b={container:this.ssA.getContainer(),slideA:this.ssA.getSlide(),slideB:this.ssB.getSlide(),duration:a===0?this.duration:this.duration*(1-a),percent:a,overflow:this.overflow};h.animation(this.animation,b)},start:function(){if(this.timer.isCounting){return false}this.setProperties(arguments[0]);if(this.timer.isTiming){this.timer.start()}else{this.ssB.getWrapper().css("z-index",this.queue);this.ssB.getWrapper().css("visibility","visible");this.timer.start(this.duration,this.callback)}this.animate();return true},stop:function(){this.timer.stop();this.ssA.getWrapper().find("*").stop(true);this.ssB.getWrapper().find("*").stop(true);return true},reset:function(){this.timer.reset();this.stop();this.ssA.getSlide().css({top:"0px",left:"0px"});this.ssB.getSlide().css({top:"0px",left:"0px"});this.ssA.getWrapper().css({visibility:"hidden","z-index":0});this.ssB.getWrapper().css("z-index",0);this.ssA=false;this.ssB=false;this.animation="fade";this.duration=1e3;this.queue=1;this.overflow=false;this.callback=false}};h.animation=function(b,c){var d={fade:function(a){var b=parseFloat(a.slideB.css("opacity"));if(b===1){a.slideB.css({opacity:0})}if(a.percent>0){a.slideB.css({opacity:a.percent})}a.slideB.animate({opacity:1},a.duration)},slideLeft:function(a){var b=a.percent===0?a.container.innerWidth():parseInt(a.slideB.css("left"));a.slideB.css("left",b+"px");a.slideB.animate({left:"-="+b},a.duration);if(a.slideA){a.slideA.css("left",b-a.container.innerWidth()+"px");a.slideA.animate({left:"-="+b},a.duration)}},slideLeftOver:function(a){var b=a.percent===0?a.container.innerWidth():parseInt(a.slideB.css("left"));a.slideB.css("left",b+"px");a.slideB.animate({left:"-="+b},a.duration)},slideRight:function(a){var b=a.percent===0?a.slideB.innerWidth():Math.abs(parseInt(a.slideB.css("left")));a.slideB.css("left",-b+"px");a.slideB.animate({left:"+="+b},a.duration);if(a.slideA){a.slideA.css("left",-b+a.slideB.outerWidth()+"px");a.slideA.animate({left:"+="+b},a.duration)}},slideRightOver:function(a){var b=a.percent===0?a.slideB.innerWidth():Math.abs(parseInt(a.slideB.css("left")));a.slideB.css("left",-b+"px");a.slideB.animate({left:"+="+b},a.duration)},slideUp:function(a){var b=a.percent===0?a.container.innerHeight():parseInt(a.container.innerHeight()*(1-a.percent));a.slideB.css("top",b+"px");a.slideB.animate({top:"-="+b},a.duration);if(a.slideA){a.slideA.css("top",b-a.container.innerHeight()+"px");a.slideA.animate({top:"-="+b},a.duration)}},slideUpOver:function(a){var b=a.percent===0?a.container.innerHeight():parseInt(a.container.innerHeight()*(1-a.percent));a.slideB.css("top",b+"px");a.slideB.animate({top:"-="+b},a.duration)},slideDown:function(a){var b=a.percent===0?a.slideB.innerHeight():parseInt(a.slideB.innerHeight()*(1-a.percent));a.slideB.css("top",-b+"px");a.slideB.animate({top:"+="+b},a.duration);if(a.slideA){a.slideA.css("top",-b+a.slideA.outerHeight()+"px");a.slideA.animate({top:"+="+b},a.duration)}},slideDownOver:function(a){var b=a.percent===0?a.slideB.innerHeight():parseInt(a.slideB.innerHeight()*(1-a.percent));a.slideB.css("top",-b+"px");a.slideB.animate({top:"+="+b},a.duration)}};if(typeof b==="string"){if(c.overflow===true){var e=b.indexOf("Over");if(e===-1){b+="Over"}}if(typeof d[b]==="function"){d[b](c)}else{d.fade(c)}}else if(typeof b==="function"){b(c)}else{a.error("Simple Slides Error: invalid transition. Transitions must "+"be of type string or function.")}};var i={init:function(c){a(this).css("overflow","hidden");var d=a.extend(true,{json:false,loader:false,slide:0,transition:{"default":{duration:1e3,animation:"fade"}},duration:2e3,autostart:false,overflow:false,maxOverflow:5},c,{id:Math.round((Math.random()-1e-5)*1e5),total:0,state:new e,timer:new g});d.transitions=[new h(d.timer)];return this.each(function(){if(d.json){for(var c=0;c<d.json.length;c++){b.appendImage(a(this),d.json[c])}}delete d.json;d.total=a(this).children().length;if(a(this).children(".simpleSlides.loader").length===0){if(d.loader){if(typeof d.loader==="string"){d.loader={img:d.loader,"class":".simpleSlides.loader"}}else if(typeof d.loader==="object"){var e=" .simpleSlides.loader";if(typeof d.loader.class==="string"){d.loader.class+=e}else{d.loader.class=e}}b.appendImage(a(this),d.loader)}}else{d.total-=1}d.loader=new f;if(d.slide>=d.total||d.slide<0){d.slide=0}var g=b.wrapElement(a(this).children().first());g.data("SimpleSlides.loaded",false);var h=g.height();var j=0;a(this).children().not(":eq(0)").each(function(){j+=h;g=b.wrapElement(a(this));g.css("top",-j+"px");g.data("SimpleSlides.loaded",false)});a(this).children().not(":eq("+d.slide+")").css("visibility","hidden");a(this).addClass("simpleSlides"+d.id);a(this).data("SimpleSlides.global",d);if(d.autostart){i.play.call(a(this))}})},play:function(){this.each(function(){var b=a(this);var c=b.data("SimpleSlides.global");var d=c.state.getState();c.state.setState("play");switch(d){case"pause-in":c.timer.start();break;case"pause-tr":for(var e=0;e<c.transitions.length;e++){c.transitions[e].start()}break;case"stop-in":c.timer.start(c.duration,function(){i.next.call(b)});break}})},pause:function(){this.each(function(){var b=a(this).data("SimpleSlides.global");var c=b.state.getState();if(c!=="load"&&c!=="stop-in"&&c!=="stop-tr"){b.state.setState("pause")}switch(c){case"play-in":b.timer.stop();break;case"play-tr":for(var d=0;d<b.transitions.length;d++){b.transitions[d].stop()}break}})},stop:function(){this.each(function(){var b=a(this).data("SimpleSlides.global");var c=b.state.getState();if(c==="pause-in"||c==="pause-tr"){return false}if(c==="play-in"){b.timer.reset()}b.state.setState("stop")})},previous:function(){this.each(function(){var b=a(this).data("SimpleSlides.global");var d=b.slide===0?b.total-1:b.slide-1;c.goTo.call(a(this),d)})},next:function(){this.each(function(){var b=a(this).data("SimpleSlides.global");var d=b.total===b.slide+1?0:b.slide+1;c.goTo.call(a(this),d)})},goTo:function(b){this.each(function(){var c=a(this).data("SimpleSlides.global");var e=c.state.getState();var f=new d(c.id,c.slide);var g=new d(c.id,b);if(!g.getWrapper().data("SimpleSlides.loaded")){c.loader.load(g);return false}var j=typeof c.transition[b]==="undefined"?c.transition.default:c.transition[b];if(typeof j==="string"||typeof j==="function"){j={animation:j,duration:c.transition.default.duration}}else if(typeof j==="object"){if(typeof j.duration==="undefined"){j.duration=c.transition.default.duration}if(typeof j.animation==="undefined"){j.animation=c.transition.default.animation}}if(e==="play-tr"||e==="stop-tr"){var k=new h;c.transitions.push(k)}c.slide=b;c.state.setState("tr");c.transitions[c.transitions.length-1].start({ssA:f,ssB:g,animation:j.animation,duration:j.duration,queue:c.transitions.length,overflow:c.overflow,callback:function(){if(c.slide===g.getWrapper().index()){c.state.setState("no-tr");for(var a=0;a<c.transitions.length;a++){c.transitions[a].reset()}c.transitions.length=1;if(c.state.getState()==="play-in"){c.state.setState("stop");i.play.call(g.getContainer())}}}})})},destroy:function(){this.each(function(){var b=a(this).data("SimpleSlides.global");for(var c=0;c<b.transitions.length;c++){b.transitions[c].reset()}b.timer.reset();a(this).children().each(function(){a(this).removeData("SimpleSlides.loaded")});a(this).removeData("SimpleSlides.global")})}};a.fn.simpleSlides=function(b){if(i[b]){c.methods.apply(this,arguments);return this}else if(typeof b==="object"||!b){return i.init.apply(this,arguments)}else{a.error("Method "+b+" does not exist on jQuery.simpleSlides")}}})(jQuery)
